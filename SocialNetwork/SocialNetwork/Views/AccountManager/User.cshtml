﻿@using Microsoft.AspNetCore.Identity;
@using SocialNetwork.Data.Models;
@inject SignInManager<User> SignInManager
@inject UserManager<User> UserManager;

@model SocialNetwork.ViewModels.Account.UserViewModel;
@{
	ViewData["Title"] = "User";
}
@if (SignInManager.IsSignedIn(User))
{

	<form asp-controller="AccountManager" asp-action="Logout" method="post">
		<div class="exbutton">
			<button type="submit" class="btn btn-sm btn-primary">
				Выход
			</button>
		</div>
	</form>
	<h3>
		@Model.User.LastName @Model.User.FirstName
	</h3>
	<div class="user_page">
		<img class="main-img" src="@Model.User.Image" />
		<div class="user_info">
			<p class="user_page_text">
				Статус:
			</p> @Model.User.Status
		</div>
		<div class="user_info">
			<p class="user_page_text">
				Дата рождения:
			</p> @Model.User.BirthDate
		</div>
		<div class="user_info">
			<p class="user_page_text">
				О себе:
			</p> @Model.User.About
		</div>
		<div class="user_info">
			<p class="user_page_text">
				Email:
			</p> @Model.User.Email
		</div>
	</div>
	<div style="display:block">
		<form method="get" asp-controller="AccountManager" asp-action="Edit">
			<input class="enter_submit" type="submit" value="Редактировать" />
		</form>
	</div>
	<div>
		<label class="gray-text">Список друзей</label>
		@if (Model.Friends.Count != 0)
		{
			<div>
				@foreach (var user in @Model.Friends)
				{
					<div class="fr">
						<div class="mrgn center-align">
							<img src="@user.Image" class="ava" />
						</div>
						<div class="mrgn center-align">
							@user.GetFullName()
						</div>
						<div class="mrgn center-align">
							<form asp-controller="AccountManager" asp-action="Chat" asp-route-id="@user.Id" method="post">
								<button type="submit" class="btn btn-sm btn-primary min-width-but">
									Чат
								</button>
							</form>
						</div>
						<div class="mrgn center-align">
							<form asp-controller="AccountManager" asp-action="DeleteFriend" asp-route-id="@user.Id" method="post">
								<button type="submit" class="btn btn-sm btn-primary">
									Удалить из друзей
								</button>
							</form>
						</div>
					</div>
				}
			</div>
		}
		else
		{
			<div>
				<label> У вас пока нет друзей.</label>
			</div>
		}
	</div>
}

